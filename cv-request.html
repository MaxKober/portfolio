<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Request CV — Max Kober</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Fonts: same as index -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <!-- CSS: same file as site (cache-bust to ensure fresh load) -->
  <link rel="stylesheet" href="./style.css?v=3">
</head>

<body class="cv-page">

  <div class="wrapper">
    <section class="card" 
      <a href="./index.html" class="close-btn" title="Close form and go back">&#10005;</a>

      <h1 class="title" >Request My CV</h1>
      <p class="subtitle" >Please provide your details below to receive a copy of my CV.</p>

      <form action="https://formspree.io/f/xdkwqkyr" method="POST" class="cv-form" id="cv-form" novalidate">
        <input type="text" name="_gotcha" style="display:none">

        <label>
          Full Name
          <input type="text" name="name" id="name" required placeholder="e.g., John Doe">
        </label>

        <label>
          Company Name
          <input type="text" name="company" id="company" required placeholder="e.g., BuildSmart Ltd.">
        </label>

        <label>
          Email Address
          <input type="email" name="_replyto" id="email" required placeholder="e.g., john@buildsmart.com">
        </label>

        <label>
          Comments / Job Description (optional)
          <textarea name="message" id="message" rows="4" placeholder="e.g., Please share your CV for our upcoming project."></textarea>
        </label>

        <input type="hidden" name="_subject" value="New CV Request from Portfolio">

        <!-- <button type="submit" class="button" id="submit-btn">Submit request</button> -->
        <button type="submit" class="btn" id="submit-btn">Submit request</button>

        <p id="form-status" class="muted" style="margin-top:10px;"></p>
      </form>
    </section>

    <footer style="margin-top:28px" class="muted">
      © <span id="y"></span> Max Kober — <a href="./index.html">Back to portfolio</a>
    </footer>
  </div>

  <script>
    document.getElementById('y').textContent = new Date().getFullYear();

    const form = document.getElementById('cv-form');
    const statusEl = document.getElementById('form-status');
    const btn = document.getElementById('submit-btn');

    function validate() {
      statusEl.textContent = '';
      const name = form.name.value.trim();
      const company = form.company.value.trim();
      const email = form._replyto.value.trim();
      if (!name) { statusEl.textContent='Please enter your name.'; statusEl.className='error'; return false; }
      if (!company) { statusEl.textContent='Please enter your company name.'; statusEl.className='error'; return false; }
      if (!/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(email)) { statusEl.textContent='Please enter a valid email address.'; statusEl.className='error'; return false; }
      return true;
    }

    form.addEventListener('submit', async e => {
      e.preventDefault();
      if (!validate()) return;

      const data = new FormData(form);
      if (data.get('_gotcha')) return;

      btn.disabled = true;
      try {
        const res = await fetch(form.action, { method: form.method, body: data, headers: {Accept:'application/json'} });
        if (res.ok) {
          statusEl.textContent = 'Thank you! Your request has been sent. Redirecting...';
          statusEl.className = 'success';
          form.reset();
          setTimeout(()=>window.location.href='./index.html#cv-thanks', 2500);
        } else {
          statusEl.textContent = 'Something went wrong. Please try again later.'; statusEl.className='error';
        }
      } catch {
        statusEl.textContent = 'Network error. Please try again.'; statusEl.className='error';
      } finally {
        btn.disabled = false;
      }
    });
  </script>
</body>
